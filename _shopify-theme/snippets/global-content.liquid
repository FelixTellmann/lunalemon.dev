{%- capture blogObject -%}
  {
  "all_tags": {{ blog.all_tags | json }},
  "articles": {{ blog.articles | json }},
  "articles_count": {{ blog.articles_count | json }},
  "comments_enabled": {{ blog.comments_enabled | json }},
  "handle": {{ blog.handle | json }},
  "id": {{ blog.id | json }},
  "moderated": {{ blog.moderated | json }},
  "next_article": {{ blog.next_article | json }},
  "previous_article": {{ blog.previous_article | json }},
  "tags": {{ blog.tags | json }},
  "title": {{ blog.title | json }}
  }
{%- endcapture -%}

{%- capture pageObject -%}
  {
  "author": {{ page.author | json }},
  "content": {{ page.content | json }},
  "handle": {{ page.handle | json }},
  "id": {{ page.id | json }},
  "published_at": "{{ page.published_at }}",
  "template_suffix": {{ page.template_suffix | json }},
  "title": {{ page.title | json }},
  "url": {{ page.url | json }}
  }
{%- endcapture -%}

{%- capture requestObject -%}
  {
  "design_mode": {{ request.design_mode | json }},
  "host": {{ request.host | json }},
  "locale": {{ request.locale | json }},
  "origin": {{ request.origin | json }},
  "path": {{ request.path | json }},
  "page_type": {{ request.page_type | json }}
  }
{%- endcapture -%}

{%- capture linklistsObject -%}
  [
  {%- for linklist in linklists -%}
    {
    "handle": {{ linklist.handle | json }},
    "levels": {{ linklist.levels | json }},
    "links": [
    {% for link in linklist.links  %}
      {
        "active": {{ link.active | json }},
        "child_active": {{ link.child_active |json }},
        "current": {{ link.current |json }},
        "child_current": {{ link.child_current |json }},
        "levels": {{ link.levels |json }},
        "links": [
        {% for sub_link in link.links  %}
          {
          "active": {{ sub_link.active | json }},
          "child_active": {{ sub_link.child_active |json }},
          "current": {{ sub_link.current |json }},
          "child_current": {{ sub_link.child_current |json }},
          "levels": {{ sub_link.levels |json }},
          "links": [
          {% for sub_sub_link in sub_link.links  %}
            {
            "active": {{ sub_sub_link.active | json }},
            "child_active": {{ sub_sub_link.child_active |json }},
            "current": {{ sub_sub_link.current |json }},
            "child_current": {{ sub_sub_link.child_current |json }},
            "levels": {{ sub_sub_link.levels |json }},
            "links": {{ sub_sub_link.links |json }},
            "object": {{ sub_sub_link.object |json }},
            "title": {{ sub_sub_link.title |json }},
            "type": {{ sub_sub_link.type |json }},
            "url": {{ sub_sub_link.url |json }}
            }{%- unless forloop.last -%},{%- endunless -%}
          {% endfor %}],
          "object": {{ sub_link.object |json }},
          "title": {{ sub_link.title |json }},
          "type": {{ sub_link.type |json }},
          "url": {{ sub_link.url |json }}
          }{%- unless forloop.last -%},{%- endunless -%}
        {% endfor %}],
        "object": {{ link.object |json }},
        "title": {{ link.title |json }},
        "type": {{ link.type |json }},
        "url": {{ link.url |json }}
      }{%- unless forloop.last -%},{%- endunless -%}
    {% endfor %}],
    "title": {{ linklist.title | json }}
    }{%- unless forloop.last -%},{%- endunless -%}
  {% endfor %}
  ]
{%- endcapture -%}

{%- capture shopObject -%}
  {
  "address": {{ shop.address | json }},
  "address_city": {{ shop.address.city | json }},
  "address_company": {{ shop.address.company | json }},
  "address_country": {{ shop.address.country | json }},
  "address_country_upper": {{ shop.address.country_upper | json }},
  "address_province": {{ shop.address.province | json }},
  "address_province_code": {{ shop.address.province_code | json }},
  "address_street": {{ shop.address.street | json }},
  "address_summary": {{ shop.address.summary | json }},
  "address_zip": {{ shop.address.zip | json }},
  "checkout.guest_login": {{ shop.checkout.guest_login | json }},
  "collections_count": {{ shop.collections_count | json }},
  "currency": {{ shop.currency | json }},
  "customer_accounts_enabled": {{ shop.customer_accounts_enabled | json }},
  "customer_accounts_optional": {{ shop.customer_accounts_optional | json }},
  "description": {{ shop.description | json }},
  "domain": {{ shop.domain | json }},
  "email": {{ shop.email | json }},
  "enabled_payment_types": {{ shop.enabled_payment_types | json }},
  "id": {{ shop.id | json }},
  "money_format": {{ shop.money_format | json }},
  "money_with_currency_format": {{ shop.money_with_currency_format | json }},
  "name": {{ shop.name | json }},
  "password_message": {{ shop.password_message | json }},
  "permanent_domain": {{ shop.permanent_domain | json }},
  "phone": {{ shop.phone | json }},
  "policies": {{ shop.policies | json }},
  "privacy_policy": {{ shop.privacy_policy | json }},
  "published_locales": {{ shop.published_locales | json }},
  "refund_policy": {{ shop.refund_policy | json }},
  "shipping_policy": {{ shop.shipping_policy | json }},
  "subscription_policy": {{ shop.subscription_policy | json }},
  "terms_of_service": {{ shop.terms_of_service | json }},
  "products_count": {{ shop.products_count | json }},
  "secure_url": {{ shop.secure_url | json }},
  "types": {{ shop.types | json }},
  "url": {{ shop.url | json }},
  "vendors": {{ shop.vendors | json }}
  }
{%- endcapture -%}
<script type="application/json" data-global>
  {
    "settings": {{ settings | json }},
    "shop": {{ shopObject }},
    "request": {{ requestObject }},
    "linklists": {{ linklistsObject }},
    "product": {{ product | json }},
    "collection": {{ collection | json }},
    "page": {%- if page -%}{{ pageObject }}{%- else -%}null{%- endif -%},
    "blog": {%- if blog -%}{{ blogObject }}{%- else -%}null{%- endif -%},
    "article": {{ article | json }},
    "handle": {{ handle | json }},
    "description": {{ page_description | json }},
    "title": {{ page_title | json }},
    "template": {{ template | json }}
  }


</script>
